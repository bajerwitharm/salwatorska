select strftime('%H',usage_by_hour.timestamp) as hour,users.mac as mac, name, account, sum(data_in) as data_in,sum(data_out) as data_out from usage_by_hour join users on usage_by_hour.user_id=users.id left join connections using(user_id) group by usage_by_hour.timestamp,usage_by_hour.user_id;