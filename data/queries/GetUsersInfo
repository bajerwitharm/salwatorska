select t1.firstseen,t1.lastseen,t1.name,t1.mac,t2.accounts,t1.data_in,t1.data_out,t2.connections from (select users.timestamp AS firstseen,usage.timestamp AS lastseen,users.name AS name,mac,data_in,data_out from usage join users on usage.user_id=users.id group by mac) t1 left join (select mac,group_concat(DISTINCT account) AS accounts, count(*) AS connections from connections group by mac) t2 on t1.mac=t2.mac;